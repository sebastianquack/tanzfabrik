<ul>
<% tree.each_pair do |k,v| %>

<li> <%= link_to k.name, page_path(k.page) if k.page %>

<% if v %>
  <%= render :partial => "navigation/tree_node", :locals => {:tree => v} %>
<% end %>

</li>

<% end %>
</ul>